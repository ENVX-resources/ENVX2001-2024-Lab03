[
  {
    "objectID": "Lab03.html#exercise-1-diatoms-walk-through",
    "href": "Lab03.html#exercise-1-diatoms-walk-through",
    "title": "Lab 02",
    "section": "Exercise 1 – diatoms (walk-through)",
    "text": "Exercise 1 – diatoms (walk-through)\nMedley & Clements (1998) sampled 34 locations along streams for diversity of diatoms. Each site was classified according to the Zn concentration in the water. There were 4 classes; background, low, medium and high. Were there differences between each of the groupings in term of diatom diversity? Let’s find out.\nImport the Diatoms worksheet from the diatoms.xlsx file into R. Download the data below:\n diatoms.xlsx \nIf you have difficulty with this step please refer to this week’s tutorial on importing MS Excel files.\nlibrary(readxl)\n\n# You will need to look at the Excel file and work out \n# the correct worksheet name and range:\ndiatoms &lt;- read_excel(\n    path = \"diatoms.xlsx\",\n    sheet = ...,\n    range = ...\n)\n\nWorkflow\nWe will briefly go through a typical analytical workflow which involves data exploration, model fitting, checking of model assumptions1 and interpretation of the results.\n1 Assumptions will be covered formally next week when we look at model residuals.\n\nData exploration\n\nData structure\nChecking the structure of the data is the first step in any data analysis. This is done using the str() function in R.\nstr(diatoms)\nOf particular interest are the variables Stream and Zinc, which have been classified as characters (chr).\n\n\ntibble [34 × 4] (S3: tbl_df/tbl/data.frame)\n $ Stream   : chr [1:34] \"Eagle\" \"Blue\" \"Blue\" \"Blue\" ...\n $ Zinc     : chr [1:34] \"BACK\" \"BACK\" \"BACK\" \"BACK\" ...\n $ Diversity: num [1:34] 2.27 1.7 2.05 1.98 2.2 1.53 0.76 1.89 1.4 2.18 ...\n $ Group    : num [1:34] 1 1 1 1 1 1 1 1 2 2 ...\n\n\nThese variables are most likely factors and should be converted to such. This can be done using as.factor().\n\ndiatoms$Zinc &lt;- as.factor(diatoms$Zinc)\ndiatoms$Stream &lt;- as.factor(diatoms$Stream)\n\n\n\n\n\n\n\nTip\n\n\n\nThe tidyverse approach – We can use the mutate() function to convert the Zinc and Stream variables to factors.\nlibrary(dplyr)\ndiatoms &lt;- diatoms %&gt;%\n    mutate(\n        Zinc = as.factor(Zinc),\n        Stream = as.factor(Stream)\n    )\n\n\nWe can then check if the conversion was successful by using the str() function again.\n\nstr(diatoms)\n\ntibble [34 × 4] (S3: tbl_df/tbl/data.frame)\n $ Stream   : Factor w/ 6 levels \"Arkan\",\"Blue\",..: 4 2 2 2 5 6 6 6 1 1 ...\n $ Zinc     : Factor w/ 4 levels \"BACK\",\"HIGH\",..: 1 1 1 1 1 1 1 1 3 3 ...\n $ Diversity: num [1:34] 2.27 1.7 2.05 1.98 2.2 1.53 0.76 1.89 1.4 2.18 ...\n $ Group    : num [1:34] 1 1 1 1 1 1 1 1 2 2 ...\n\n\n\n\nSummary statistics\nUse summary() for a quick overview of common statistical measures for each variable in the data frame. However it is not informative when we are interested in differences between groups or factors as it only gives the summary statistics for the entire data set.\n\nsummary(diatoms)\n\n   Stream    Zinc     Diversity         Group      \n Arkan:7   BACK:8   Min.   :0.630   Min.   :1.000  \n Blue :7   HIGH:9   1st Qu.:1.377   1st Qu.:2.000  \n Chalk:5   LOW :8   Median :1.855   Median :3.000  \n Eagle:4   MED :9   Mean   :1.694   Mean   :2.559  \n Snake:5            3rd Qu.:2.058   3rd Qu.:3.750  \n Splat:6            Max.   :2.830   Max.   :4.000  \n\n\nIt is more useful to calculate summary statistics for each level of Zn contamination, as we are interested in differences between the mean of each group.\nWe can use the tapply() function to calculate the mean and standard deviation for each level of Zinc. This has to be done separately for each summary statistic (mean and standard deviation).\nThe general structure of the tapply() function is 3 arguments which are described below based on the code above:\n\nthe response variable on which we wish to apply the function, diatoms$Diversity;\nthe categorical variable which indicates the groups we wish to separately apply the function to, diatoms$Zinc;\nthe function we are using, mean().\n\n\ntapply(\n    X = diatoms$Diversity,\n    INDEX = diatoms$Zinc,\n    FUN = mean\n)\n\n    BACK     HIGH      LOW      MED \n1.797500 1.277778 2.032500 1.717778 \n\ntapply(\n    X = diatoms$Diversity,\n    INDEX = diatoms$Zinc,\n    FUN = sd\n)\n\n     BACK      HIGH       LOW       MED \n0.4852613 0.4268717 0.4449960 0.5030104 \n\n\n\n\n\n\n\n\nTip\n\n\n\nThe tidyverse approach – Use the group_by() and summarise() functions to calculate the mean and standard deviation for each level of Zinc. The code is longer, but readable as you can see the sequence of operations.\ndiatoms %&gt;%\n    group_by(Zinc) %&gt;%\n    summarise(\n        mean = mean(Diversity),\n        sd = sd(Diversity)\n    )\n\n\n\n\nGraphical summaries\nNumerical summaries are nice, but visual summaries are often more informative and are the summary of choice for publication. They can also help us to check the assumptions of the statistical test (although sometimes this is not possible until we have fitted the model).\nIn the case of ANOVA model we are interested in the distribution of the response variable for each level of the factor. The table below gives heuristic rules about which graphical summary to use based on the number of observations.\n\n\n\nWe will show examples of both the histogram and boxplot for the diatom data. We recommend that you use ggplot2 for your graphical summaries as it is more flexible and has a more consistent syntax than base R graphics. However, we will show both approaches here.\n\nHistogram\nAs there are less than 10 observations per group the histogram may not be very informative. However, it may still be useful for checking the normality of the data. You may be able to see the limitations of the histogram for small sample sizes.\n\n\n\n\n\n\nTip\n\n\n\nTo calculate the number of observations per group:\ntapply(\n    X = diatoms$Diversity,\n    INDEX = diatoms$Zinc,\n    FUN = length\n)\n\n\n\nggplot2base R (no loops)base R (loops)\n\n\n\nlibrary(ggplot2)\nggplot(diatoms, aes(x = Diversity)) +\n    geom_histogram(binwidth = .3) +\n    facet_wrap(~Zinc)\n\n\n\n\n\n\n\n\n\n\n\npar(mfrow = c(2, 2))\nhist(\n    x = diatoms$Diversity[diatoms$Zinc == \"BACK\"],\n    main = \"Zinc: BACK\",\n    xlab = \"Diversity\"\n)\nhist(\n    x = diatoms$Diversity[diatoms$Zinc == \"HIGH\"],\n    main = \"Zinc: HIGH\",\n    xlab = \"Diversity\"\n)\nhist(\n    x = diatoms$Diversity[diatoms$Zinc == \"LOW\"],\n    main = \"Zinc: LOW\",\n    xlab = \"Diversity\"\n)\nhist(\n    x = diatoms$Diversity[diatoms$Zinc == \"MED\"],\n    main = \"Zinc: MED\",\n    xlab = \"Diversity\"\n)\n\n\n\n\n\n\n\n\n\n\n\npar(mfrow = c(2, 2))\nfor (i in levels(diatoms$Zinc)) {\n    hist(\n        x = diatoms$Diversity[diatoms$Zinc == i],\n        main = paste(\"Zinc:\", i),\n        xlab = \"Diversity\"\n    )\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\nBoxplot\nA more appropriate plot for this data is the boxplot. If we want to format the plot for publication we should make the plot clear by adding axis labels and a figure caption.\n\nbase Rggplot2\n\n\n\nboxplot(\n    Diversity ~ Zinc,\n    data = diatoms,\n    ylab = \"Diversity\",\n    xlab = \"Zinc concentration\"\n)\n\n\n\n\n\n\n\nFigure 1: Boxplot of diatom diversity by Zinc concentration.\n\n\n\n\n\n\n\n\nggplot(diatoms, aes(x = Zinc, y = Diversity)) +\n    geom_boxplot() +\n    ylab(\"Diversity\") +\n    theme_minimal(base_size = 12)\n\n\n\n\n\n\n\nFigure 2: Boxplot of diatom diversity by Zinc concentration.\n\n\n\n\n\n\n\n\n\n\n\n\nQuestion 1\nWhat can you say about the the different levels of Zinc from looking at the mean and standard deviation values when running the following?\ntapply(\n    X = diatoms$Diversity,\n    INDEX = diatoms$Zinc,\n    FUN = mean\n)\n\ntapply(\n    X = diatoms$Diversity,\n    INDEX = diatoms$Zinc,\n    FUN = sd\n)\n\n\nQuestion 2\nCan you interpret and describe the boxplot above?\n\n\nModel fitting\nA 1-way ANOVA involves one treatment (or grouping) factor. The model we are fitting is:\ny_{i,j} =\\mu_i+\\epsilon_{i,j}\nwhere:\n\ny_{i,j} is the response for observation j in treatment (or group) i,\n\\mu_j is the mean of treatment (or group) i,\n\\epsilon_{i,j} is the residual term which is an independent random variable that has a mean of 0, constant variance and is normally distributed. This can be expressed shorthand as \\sim N(0,\\sigma_2). The residual MS estimates \\sigma_2.\n\nThe statistical hypotheses we are testing are:\nH_{0}: \\mu_1 = \\mu_2 = ... \\mu_t H_{1}: \\text{not all } \\mu_j \\text{ are equal}\nThe code below fits the anova model using the aov function and saves the it to an object called anova.diatoms. We can then extract the ANOVA table using the summary function.\n\nanova.diatoms &lt;- aov(formula = Diversity ~ Zinc, data = diatoms)\nsummary(anova.diatoms)\n\n            Df Sum Sq Mean Sq F value Pr(&gt;F)  \nZinc         3  2.567  0.8555   3.939 0.0176 *\nResiduals   30  6.516  0.2172                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nAssumptions and interpretation of results\nThe assumptions of the ANOVA model are:\n\nThe residuals are independent,\nThe residuals are normally distributed,\nThe residuals have constant variance.\n\nBased on the boxplots and histograms during data exploration, the assumptions of normality and equal variances are met. We will discuss assumptions again in greater detail next week when we start to look at residuals.\nWe can only interpret the results of the ANOVA model if the assumptions are met. Reporting can be done in the following way:\n\nThe results indicate that there are significant differences between the levels of Zn concentration in terms of diatom diversity (F = 3.9, df = 3, 30, P = 0.02).\n\n\n\nPost-hoc testing\n\nReporting: The ANOVA test only tells us that there are differences between the groups, but it does not tell us which groups are different. We can use the emmeans package to perform post-hoc testing.\n\n\nlibrary(emmeans)\nposthoc &lt;- emmeans(anova.diatoms, \"Zinc\")\nposthoc\n\n Zinc emmean    SE df lower.CL upper.CL\n BACK   1.80 0.165 30    1.461     2.13\n HIGH   1.28 0.155 30    0.961     1.60\n LOW    2.03 0.165 30    1.696     2.37\n MED    1.72 0.155 30    1.401     2.04\n\nConfidence level used: 0.95 \n\n\nThe output of the emmeans function gives us the estimated marginal means for each level of Zinc and the 95% confidence intervals. The confidence intervals for the HIGH level of Zn concentration do not overlap with the other levels of Zn concentration, indicating that the HIGH level of Zn concentration is significantly different from the other levels.\n\nReporting: The post-hoc test indicates that the HIGH level of Zn concentration is significantly different from the other levels of Zn concentration. There are no other significant differences.\n\nWe can visualise the results of the post-hoc testing using the plot function, if you prefer a visual representation.\n\nplot(posthoc)"
  },
  {
    "objectID": "Lab03.html#exercise-2-chicks",
    "href": "Lab03.html#exercise-2-chicks",
    "title": "Lab 02",
    "section": "Exercise 2 – chicks",
    "text": "Exercise 2 – chicks\nAn experiment was designed to compare 15-day mean comb weights (g) of two lots of male chicks, one receiving sex hormone A (testosterone), the other C (dehydroandrosterone). While we usually analyse these data by using a (pooled) two-sample t-test, a single factor analysis of variance approach could be used (with two levels of the treatment factor). We will compare the results from both analyses.\nThe data is found in the Comb worksheet of the chick_marigold.xlsx file. Download it below:\n chick_marigold.xlsx \nRead the data and save it as comb. It should look like below:\n\ncombs\n\n# A tibble: 22 × 2\n   CombWt Hormone\n    &lt;dbl&gt; &lt;chr&gt;  \n 1     57 A      \n 2    120 A      \n 3    101 A      \n 4    137 A      \n 5    119 A      \n 6    117 A      \n 7    104 A      \n 8     73 A      \n 9     53 A      \n10     68 A      \n# ℹ 12 more rows\n\n\n\nQuestion 3\nPerform some checks to verify the two-sample t-test (or one-way ANOVA) is appropriate, i.e. investigate the shape of the distributions, and the standard deviations.\n\n\nQuestion 4\nIn R, perform a 2-sample t-test using the t.test() function, and use the var.equal = TRUE argument to ensure a standard 2-sample t-test is performed. Interpret the output.\n\n\nQuestion 5\nNext, perform a one-way ANOVA using the aov function, followed by summary, and interpret the results.\n\n\nQuestion 6\nCompare the t-test and ANOVA outputs. What do you notice about:\n\nthe degrees of freedom;\nthe P-value?\n\n\n\nQuestion 7\nWhen there are only two treatment groups, the observed F and t values are related by F = t^2. Demonstrate this for the observed values in this exercise."
  },
  {
    "objectID": "Lab03.html#exercise-3-lambs",
    "href": "Lab03.html#exercise-3-lambs",
    "title": "Lab 02",
    "section": "Exercise 3 – lambs",
    "text": "Exercise 3 – lambs\nWork on this exercise in your own time.\nThe levels of immunoglobulin (Ig) in blood serum (g/100 ml) in 3 breeds of newborn lambs have been investigated. A total of 44 lambs were sampled, with approximately equal numbers per breed. The researcher wants to know whether or not there are significant differences in immunoglobulin levels between the breeds.\nThe data is found in lambs.csv. Download the data if you have not done so:\n lambs.csv \nRead the data into R and save it as lambs. Use the read_csv() function which should be available when you load the tidyverse package.\nIt should look like below:\n\nlambs\n\nBased on the demonstrator walkthrough, analyse the lambs dataset and test the hypothesis that:\nH_{0}: \\mu_1 = \\mu_2 = \\mu_3 H_{1}: \\text{not all } \\mu_j \\text{ are equal}\nwhere \\mu_j is the mean Ig level for breed j.\nRemember to:\n\nState your null and alternate hypotheses.\nPlot an appropriate summary graph for the data.\nDemonstrate the model fit using the aov() function.\nTest assumptions, by checking sd values, or by looking at your exploratory plots (checking residuals is not necessary at this point).\nReport your test statistic, degrees of freedom and p-value.\nReport the statistical conclusion by addressing the null hypothesis.\nExplain the results within a biological context to the data."
  },
  {
    "objectID": "Lab03.html#thanks",
    "href": "Lab03.html#thanks",
    "title": "Lab 02",
    "section": "Thanks!",
    "text": "Thanks!\nDid you know you can also knit to PDF? Check the documentation for R Markdown or Quarto for more information.\n\nAttribution\nThis lab was developed using resources that are available under a Creative Commons Attribution 4.0 International license, made available on the SOLES Open Educational Resources repository."
  }
]